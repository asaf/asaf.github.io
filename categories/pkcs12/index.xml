<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Pkcs12 on Asaf Shakarchi</title>
    <link>http://asaf.github.io/categories/pkcs12/</link>
    <description>Recent content in Pkcs12 on Asaf Shakarchi</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 23 Aug 2016 23:30:26 +0300</lastBuildDate>
    <atom:link href="http://asaf.github.io/categories/pkcs12/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Export Certificate and Private key from JKS</title>
      <link>http://asaf.github.io/post/export_certificate_and_private_key_from_jks/</link>
      <pubDate>Tue, 23 Aug 2016 23:30:26 +0300</pubDate>
      
      <guid>http://asaf.github.io/post/export_certificate_and_private_key_from_jks/</guid>
      <description>&lt;p&gt;I had to migrate web application written in Java to NodesJS,&lt;/p&gt;

&lt;p&gt;Java web containers store certificates inside JKS Keystore where NodeJS requires certificate and private key in &lt;a href=&#34;https://nodejs.org/api/https.html&#34;&gt;PEM format&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Exporting certificate directly from JKS is easy by using &lt;em&gt;keytool&lt;/em&gt;, but exporting private key is not allowed,
To export the private key using Java, we need to interact with the keystore by writing some custom code using the Keystore java API,&lt;/p&gt;

&lt;p&gt;the other alternative is simply convert the JKS into a &lt;a href=&#34;https://en.wikipedia.org/wiki/PKCS_12&#34;&gt;PKCS12&lt;/a&gt; and export the certificate &amp;amp; key using &lt;em&gt;openssl&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Convert JKS to PKCS12 format:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;keytool -importkeystore -srckeystore mykeystore.jks -destkeystore mykeystore.p12 -deststoretype PKCS12
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note: The &lt;em&gt;-importkeystore&lt;/em&gt; parameter is only supported with the keytool that ships with Java ver 1.6+&lt;/p&gt;

&lt;p&gt;you can view the content of the pkcs12 keystore by:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;openssl pkcs12 -in mykeystore.p12
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(Specifically look for the &lt;em&gt;friendlyName&lt;/em&gt; that corresponds to the &lt;em&gt;alias&lt;/em&gt; property of in &lt;em&gt;JKS&lt;/em&gt;)&lt;/p&gt;

&lt;p&gt;Export the certificate:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;openssl pkcs12 -in mykeystore.p12 -nokeys -out cert.pem
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Export the private key (unencrypted)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;openssl pkcs12 -in mykeystore.p12  -nodes -nocerts -out key.pem
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;the &lt;em&gt;-nodes&lt;/em&gt; means &amp;ldquo;No DES&amp;rdquo;, that is &amp;ldquo;do not encrypt the private key that will be exported to key.pem&amp;rdquo;&lt;/p&gt;

&lt;p&gt;Make sure you keep the private key safe (recommended: &lt;em&gt;chmod 600 key.pem&lt;/em&gt;)&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>