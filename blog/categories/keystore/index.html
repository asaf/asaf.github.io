<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keystore &middot; Asaf Shakarchi</title>

    <meta name="description" content="&#34;Talk is cheap. Show me the code.&#34;">

    <meta name="generator" content="Hugo 0.17-DEV" />
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content="Keystore &middot; Asaf Shakarchi">
    <meta name="twitter:description" content="&#34;Talk is cheap. Show me the code.&#34;">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Keystore &middot; Asaf Shakarchi">
    <meta property="og:description" content="&#34;Talk is cheap. Show me the code.&#34;">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">

    <link rel="stylesheet" href="http://asaf.github.io/blog/css/all.min.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="Asaf Shakarchi" href="http://asaf.github.io/blog/index.xml" />
</head>
<body>


<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
        <hgroup>
            <h1 class="brand-title"><a href="http://asaf.github.io/blog">Asaf Shakarchi</a></h1>
            <h2 class="brand-tagline"> &#34;Talk is cheap. Show me the code.&#34; </h2>
        </hgroup>

        <nav class="nav">
            <ul class="nav-list">
                
                
                <li class="nav-item">
                    <a class="pure-button" href="http://asaf.github.io/blog/index.xml"><i class="fa fa-rss"></i> rss</a>
                </li>
            </ul>
        </nav>
    </div>
</div>


    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            
            <div class="posts">
                
                <h1 class="content-subhead">23 Aug 2016, 23:30</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://asaf.github.io/blog/post/export_certificate_and_private_key_from_jks/" class="post-title">Export Certificate and Private key from JKS</a>

                        <p class="post-meta">
                            
                            
                                under 
                                
                                <a class="post-category post-category-java" href="http://asaf.github.io/blog/categories/java">java</a><a class="post-category post-category-keytool" href="http://asaf.github.io/blog/categories/keytool">keytool</a><a class="post-category post-category-openssl" href="http://asaf.github.io/blog/categories/openssl">openssl</a><a class="post-category post-category-keystore" href="http://asaf.github.io/blog/categories/keystore">keystore</a><a class="post-category post-category-pkcs12" href="http://asaf.github.io/blog/categories/pkcs12">pkcs12</a><a class="post-category post-category-jks" href="http://asaf.github.io/blog/categories/jks">jks</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>I had to migrate web application written in Java to NodesJS,</p>

<p>Java web containers store certificates inside JKS Keystore where NodeJS requires certificate and private key in <a href="https://nodejs.org/api/https.html">PEM format</a>.</p>

<p>Exporting certificate directly from JKS is easy by using <em>keytool</em>, but exporting private key is not allowed,
To export the private key using Java, we need to interact with the keystore by writing some custom code using the Keystore java API,</p>

<p>the other alternative is simply convert the JKS into a <a href="https://en.wikipedia.org/wiki/PKCS_12">PKCS12</a> and export the certificate &amp; key using <em>openssl</em></p>

<p>Convert JKS to PKCS12 format:</p>

<pre><code>keytool -importkeystore -srckeystore mykeystore.jks -destkeystore mykeystore.p12 -deststoretype PKCS12
</code></pre>

<p>Note: The <em>-importkeystore</em> parameter is only supported with the keytool that ships with Java ver 1.6+</p>

<p>you can view the content of the pkcs12 keystore by:</p>

<pre><code>openssl pkcs12 -in mykeystore.p12
</code></pre>

<p>(Specifically look for the <em>friendlyName</em> that corresponds to the <em>alias</em> property of in <em>JKS</em>)</p>

<p>Export the certificate:</p>

<pre><code>openssl pkcs12 -in mykeystore.p12 -nokeys -out cert.pem
</code></pre>

<p>Export the private key (unencrypted)</p>

<pre><code>openssl pkcs12 -in mykeystore.p12  -nodes -nocerts -out key.pem
</code></pre>

<p>the <em>-nodes</em> means &ldquo;No DES&rdquo;, that is &ldquo;do not encrypt the private key that will be exported to key.pem&rdquo;</p>

<p>Make sure you keep the private key safe (recommended: <em>chmod 600 key.pem</em>)</p>

                    </div>
                </section>
                
            </div>
            

            <div class="footer">
    <div class="pure-menu pure-menu-horizontal pure-menu-open">
        <ul>
            <li>Powered by <a class="hugo" href="https://gohugo.io/" target="_blank">hugo</a></li>
        </ul>
    </div>
</div>
<script src="http://asaf.github.io/blog/js/all.min.js"></script>

        </div>
    </div>
</div>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', '', 'auto');
ga('send', 'pageview');

</script>

</body>
</html>
